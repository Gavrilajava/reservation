continue
Booking.last.table.number
Booking.last
exit
view.lookup_context.prefixes = %w[bookings]
visit bookings_path
bookings_path
continue
exit
form.find('input#table_number')[:name]
form.find('input#table_number')
form.find('input')
exit
form.find('input')
form.find('input#booking_name')
form.find('input#booking_name'
form
exit
form.find('input#table_number')
form.find('input')
form
continue
value.join(',')
value
continue
table.error_messages
table.errors.messages
continue
table.errors.messages
table.error_messages
continue
table.errors
continue
flash[:messages]
flash.messages
flash
continue
exit
valid_params.permitted?
valid_params.permitted
params
valid_params
continue
bookings
continue
bookings
continue
bookings
continue
bookings
continue
bookings[:error]
bookings
exit
bookings.length
bookings.has_key(:error)
bookings[:error]
bookings
exit
bookings[:error]
!bookings[:error]
bookings
exit
"#{'Table'.pluralize(bookings.count)} succesfully booked."
bookings.count
bookings
valid_params
exit
bookings = Booking.book(valid_params)
valid_params
continue
exit
flash[:notice]
flash[:errors]
flash
exit
params.params
params.keys
patams.keys
params.require("table").permit(:number, :capacity)
params
exit
params.permit(:table).require(:number, :capacity)
params.require(:number, :capacity)
params
valid_params
exit
params["table"]
params
params[:table]
valid_params
params.table
params
continue
exit
request
request.path
request
response
table
exit
Booking.book(@valid_params.except(:table))
Table.count
@valid_params
Booking.last
continue
Booking.get_best_tables_combination(tables, persons)
persons = @valid_params[:persons]
tables = Table.free(@valid_params[:time]).pluck(:capacity)
exit
Booking.get_best_tables_combination(tables, persons)
Posting.get_best_tables_combination(tables, persons)
persons = @valid_params[:persons]
tables = Table.free(@valid_params[:time]).pluck(:capacity)
@valid_params[:persons]
continue
Booking.get_all_tables_combinations(tables, persons)
persons = 99
tables = Table.free(@valid_params[:time]).pluck(:capacity)
exit
min_seats
combinations
exit
result
continue
less_tables
exit
index
table
less_tables
continue
Table.where.not(id: Table.occupied(time).pluck(:id))
Table.where.not(id: Table.occupied(time))
Table.where.not(id: occupied(time))
Table.free(time).count
Table.free(time)
Table.occupied(time)
Table.occupied
continue
Table.all
Table.joins(:bookings).where(bookings: { time: time })
Table.joins(:bookings).where.not(bookings: { time: time })
Table.includes(:bookings).where.not(bookings: { time: "2020-09-05 10:00:00" })
Table.joins(:bookings).where.not(bookings: { time: "2020-09-05 10:00:00" })
Table.joins(:bookings).where.not(bookings: { time: time })
Table.joins(:bookings).where(bookings: { time: time })
Booking.all
Table.all
Table.includes(:bookings).where(bookings: { time: time })
Table.includes(:bookings).where.not(bookings: { time: time })
Table.get_free(time)
continue
time
Table.get_free("2020-09-05 10:00:00").count
Table.get_free("2020-09-05 10:00:00")
time
Table.get_free(time)
Booking.last
time
